<!DOCTYPE html>
{% load bootstrap3 %}
{% load static %}
{% load gui_extras %}
{% load blog_extras %}
{% load metaprop_extras %}
{% load bootstrap_pagination %}

<html>
    <head>
        <title>Dashboard</title>
        <meta charset="utf-8">
        <meta http-equiv="cleartype" content="on">
        <meta name="MobileOptimized" content="320">
        <meta name="HandheldFriendly" content="True">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<!-- Latest compiled and minified CSS -->

<!-- Optional theme -->

<!-- Latest compiled and minified JavaScript -->
        <link rel="stylesheet" type="text/css" href="/static/css/slideout.css" />


        <link rel="stylesheet" href="/static/css/misc.css" />
        <link rel="stylesheet" href="/static/css/buttons-si.css" />

        <link href="/static/css/modal.css" rel="stylesheet" type="text/css"/>
        <link rel="stylesheet" type="text/css" href="/static/css/component.css" />
        <link rel="stylesheet" type="text/css" href="/static/css/dashboard.css" />
<!--
        <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.20/vue.js"></script>
-->
  <!--
        <script scr="https://cdnjs.cloudflare.com/ajax/libs/vue/2.3.4/vue.js"></script>
  -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.20/vue.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/vue-validator/2.1.6/vue-validator.js"></script>
        <script src="/static/js/jquery.js"></script>
        <script src="/static/js/jquery-migrate-1.2.1.js"></script>
        <script src="/static/js/tinymce/tinymce.min.js" type="text/javascript"></script>
        <script src="/static/js/tinymce/jquery.tinymce.min.js" type="text/javascript"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/slideout/0.1.12/slideout.min.js"></script>
        <style>
             .errors { color: red; }


.header-cont {
    width:100%;
    position:fixed;
    top:0px;
}
.header {
    height:50px;
    background:#F0F0F0;
    border:1px solid #CCC;
    width:100%;
    margin:0px auto;
}
.content {
    width:100%;
    background: #F0F0F0;
    border: 1px solid #CCC;
    height: 2000px;
    margin: 0px auto;
}

.avatar-small {
    height: 40px;
    width: : 40px;
    float: left;
    margin-right: 1em;
    position: relative;
    -webkit-border-radius: 50%;
    -moz-border-radius: 50%;
    border-radius: 50%;
}

.inner-textarea {
    display: block;
    width: 76%;
    margin: 0;
    -webkit-appearance: none;
    outline: none;
    font-family: "Raleway", Helvetica, Arial, sans-serif;
    font-size: 13px;
    padding: 13px 25px;
    line-height: 20px;
    color: #777777;
    background: #f3f3f3;
    border: 2px solid #d0cece;
    -webkit-border-radius: 0;
    -moz-border-radius: 0;
    border-radius: 0;
}
        </style>

    </head>

    <body>
    {% block content %}{% endblock content %}



<!-- template for the modal component -->
<script type="x/template" id="modal-template-signin">

  <div class="modal-mask" v-show="show" transition="modal">
    <div class="modal-wrapper">

 <div class="modal-container">

        <div class="modal-header">
           <div class="header-left">
             <h3><strong>SIGN IN</strong></h3>
           </div>
           <div class="header-right">
              <img src="/media/images/close_icon.png" height="20" width="20" style="margin-right:-10%;margin-top:-10%;"  @click="show = false" />
           </div>
           <div class="clear">

        </div>

        <div class="modal-body">
          <slot name="body">

        <form novalidate>

              <div class="form-login" id="form-login">

			<div style="margin-top:15%;margin-bottom:15%;padding-left:2.5%;">

		                <a class="btn-si btn-si-a btn-google"  href="{% url 'social:begin' 'google-oauth2' %}?next={{ request.path }}" style="width:100%;">Sign in with Google&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
                        </div>

                        <div style="margin-top:15%;margin-bottom:15%;padding-left:2.5%;">
                                <a class="btn-si btn-si-a btn-facebook"  href="{% url 'social:begin' 'facebook' %}?next={{ request.path }}">Sign in with Facebook&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
                        </div>

                        <div style="margin-top:15%;margin-bottom:15%;padding-left:2.5%;">
                                <a class="btn-si btn-si-a btn-twitter"  href="{% url 'social:begin' 'twitter' %}?next={{ request.path }}">Sign in with Twitter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
                        </div>
                        <div style="margin-top:15%;margin-bottom:15%;padding-left:2.5%;">

                                <a class="btn-si btn-si-a btn-linkedin" href="{% url 'social:begin' 'linkedin' %}?next={{ request.path }}">Sign in with Linked In&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
                        </div>







        </div>
        </form>

          </slot>
        </div>

</div>



    </div>

</div>
</script>
<script>

var counter = 0;
var first_name = '';
var fullname = '';
var email = '';
var modal_submit_register = 'Register';  
var modal_submit_password = 'Reset Password';  
var modal_submit_login    = 'Login';
 // register modal component
Vue.config.devtools = true;
Vue.component('modal', {
  template: '#modal-template-signin',
  props: {
    show: {
      type: Boolean,
      required: true,
      twoWay: true
    }
  }

})

new Vue({
  el: '#app',
  data: {
    showModal: false,
    active: null,
  },
  methods: {
    open: function(which, e) {
      // Prevents clicking the link from doing anything
        e.preventDefault();
        modal.active = which;
    },
    close: function (e) {
    },
    submit: function(which, e) {
            e.preventDefault();
    }


  },

  ready: function () {
  }
  
})

 // register modal component
Vue.component('modal', {
  template: '#modal-template-signup',
  props: {
    show: {
      type: Boolean,
      required: true,
      twoWay: true
    }
  }

})


// now we can start the app!
// router will create an instance of App and mount to
// the element matching the selector #app.

 </script>

<script src="/static/js/classie.js"></script>
<div id="fb-root"></div>
<script src="/static/js/script.js"></script>


    <script>
          var slideout = new Slideout({
                  'panel': document.getElementById('main'),
                  'menu': document.getElementById('menu'),
                  'padding': 256,
                  'tolerance': 70
          });

          document.querySelector('.js-slideout-toggle').addEventListener('click', function() {
                   slideout.toggle();
          });

          document.querySelector('.menu').addEventListener('click', function(eve) {
                   if (eve.target.nodeName === 'A') { slideout.close(); }
          });

          slideout.on('beforeopen', function() {
                   document.querySelector('.fixed').classList.add('fixed-open');
          });

          slideout.on('beforeclose', function() {
                   document.querySelector('.fixed').classList.remove('fixed-open');
          });



    </script>

<script type="text/javascript">

    var allWells = $('.admin-content');
    var allWellsExceptFirst = $('.admin-content:not(:first)');


    $(document).ready(function(){
            $('#respond_back').click(function(e) {
                sendmessage();
                openmenu('incoming');
            });

            $('#send_message').click(function(e) {
                openmenu('outgoing');
            });

            tinymce.init({
                height: '240px',
                width: '640px',
                theme_advanced_resizing: true,
                theme_advanced_resizing_use_cookie : false,
                mode : "exact",
                selector: 'textarea',
                theme: "modern",
            });    
 
            allWellsExceptFirst.hide();
            allWells.hide();
            $('#home').show();
            $('#post').bind('click',function(e) {
                alert('let us post'+$('#category_id').val());
                
            });
    });
    
    
    function openmenu(target) {
          $('#commentform').hide();
          allWells.hide();
          $('#' + target).show();
 
          if (target==='chat') {
               $('.panel-all-your-posts').hide();
               $('#allposts').hide();
               $('#editpost').hide();
               $('#appform').hide();
               $('#commentform').hide();
               $("#incoming").hide();
          }
          else if (target==='notify') {
               $('#mceu_13').removeClass("mce-tinymce mce-container mce-panel");
               $('#send-us-message').html('<textarea id="message_body" class="inner-textarea"></textarea>');
          }
          else if (target==='incoming') {
               $("#incoming").show();
               $("#chat").hide();
               $('.panel-all-your-posts').hide();
               $('#allposts').hide();
               $('#editpost').hide();
               $('#appform').hide();
               $('#commentform').hide();               
               $('.panel-incoming-messages').show();
               $('.panel-current-incoming-message').hide();


               $.ajax({
                     method: "GET",
                     url: "http://divorcesus.com/incoming/",
                     data: {}
               }).done(function( msg ) {
                           var result = '';
                           for(var i=0; i<msg.length; i++) {
                               result=result+"<div style='float:left;width:30%;'>";
                               result=result+msg[i].sender.first_name;
                               result=result+' ';
                               result=result+msg[i].sender.last_name;
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:10%;'>";
                               result=result+msg[i].time_sent;
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:29%;'>";
                               result=result+msg[i].title;
                               result=result+"</div>";


                               result=result+"<div style='float:left;width:15%;'>";

                               if (!msg[i].is_seen) {

                                  result=result+"<a href='#' id='msg-"+msg[i].id+"' onclick='readmessage("+msg[i].id+");'  style='color:blue;font-weight:bold;'>Read</a>";
                               } else {
                                  result=result+"<a href='#' id='msg-"+msg[i].id+"' onclick='readmessage("+msg[i].id+");'  style='color:blue;'>Read</a>";
                               }

                               result=result+"</div>";
                               result=result+"<div style='float:left;width:15%;'>";
                               result=result+"<a href='#' style='color:red;' onclick='deletemessage("+msg[i].id+",2);'>Delete</a>";
                               result=result+"</div>";
                               result=result+"<div class='clear'></div>";
                               result=result+"</div>"

                               if (!msg[i].is_seen) {
                                    $('#msg-'+msg[i].id).css('color','green');
                                    $('#msg-'+msg[i].id).css('font-weight','bold');
                       
                               //   $('#msg-'+msg[i].id).pulse({opacity: 0.8}, {duration : 100, pulses : 5});
                               }

                           }
                           $('.panel-incoming-messages').html(result);


              });

 
          }
          else if (target==='outgoing') {
               $("#chat").hide();
               $("#incoming").hide();

               $.ajax({
                     method: "GET",
                     url: "http://divorcesus.com/outgoing/",
                     data: { title: $('#message_title').val(),
                             message_id: $('#message_id').val(),
                             receiver_id:$('#receiver_id').val(),
                             body:tinyMCE.activeEditor.getContent()}
              }).done(function( msg ) {
                           var result = '';
                           for(var i=0; i<msg.length; i++) {
                               result=result+"<div style='float:left;width:30%;'>";
                               result=result+msg[i].receiver.first_name;
                               result=result+' ';
                               result=result+msg[i].receiver.last_name;
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:10%;'>";
                               result=result+msg[i].time_sent;
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:29%;'>";
                               result=result+msg[i].title;
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:15%;'>";
                               result=result+'Resend';
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:15%;'>";
                               result=result+"<a href='#' style='color:red;' onclick='deletemessage("+msg[i].id+",1);'>Delete</a>";
                               result=result+"</div>";
                               result=result+"<div class='clear'></div>";
                               result=result+"</div>"


                           }
                           $('.panel-outgoing-messages').html(result);
                           $('.personal').show();
                               

              });

          }

          else if(target==='newpost' || target==='allposts') {
                  
              if ( target==='newpost') {
                  $('.panel-all-your-posts').hide();
                  $("#incoming").hide(); 
                  $('#chat').hide();
                  $('#allposts').hide();
                  $('#editpost').hide();
                  $('#appform').show();
                  $('#commentform').hide();
                  resetpost();
                    
              } else if (target==='allposts') {
                  //$('.panel-all-your-posts').show();
                  $('#chat').hide();
                  $("#incoming").hide();
                  $('#allposts').show();
                  $('#editpost').hide();
                  $('#appform').hide();
                  $('#commentform').hide();

              } else if (target==='editpost') {
                  $('#chat').hide();
                  $("#incoming").hide();
                  $('#editpost').show();
                  $('#appform').hide();
                  $('#allposts').hide();
              }

              $.ajax({
                     method: "POST",
                     url: "http://divorcesus.com/getposts",
                     data: {}
              }).done(function( msg ) {
                       var result = '';

                           result=result+"<div style='width:99%;'>";
                           result=result+"<div style='float:left;width:2%;'>&nbsp;</div>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+'ID';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:45%;'>";
                           result=result+'Title';
                           result=result+"</div>";
/*
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+'Link';
                           result=result+"</div>";
  */
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'Edit';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'Delete';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'Comments';
                           result=result+"</div>";                           

                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"

                       for(var i=0;i<msg.length;i++) {
                           result=result+"<div style='width:99%;font-weight:0.8em;'>";
                           result=result+"<div style='float:left;width:2%;'>&nbsp;</div>";
                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+msg[i].id;
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:45%;'>";
                           result=result+msg[i].title;
                           result=result+"</div>";
/*
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+msg[i].link;
                           result=result+"</div>";
*/
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+"<a href='#' onclick='editpost("+msg[i].id+");'  style='color:blue;'>Edit</a>";
                           result=result+"</div>";


                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='deletepost("+msg[i].id+");'>Delete</a>";
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='postcomments("+msg[i].id+");'>Comments</a>";
                           result=result+"</div>";




                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"
                       }
                      // $('.panel-all-your-posts').show();
                       //$('.panel-all-your-posts .panel-posts').html(result);
                       $('#allposts .panel-all-posts .panel-posts').html(result);
                 //      $('.newpost').css('display','none');
                       //$('#panel-all-posts').html(result);
              });


          }    

    }


function collapse(targetId){
  if (document.getElementById){
        target = document.getElementById(targetId);
       target.style.display = "none";
  }
}

function swap(targetId){
  if (document.getElementById){
        target = document.getElementById(targetId);
            if (target.style.display == "none"){
                target.style.display = "";
            } else{
                target.style.display = "none";
            }
                
  }
}

      
Vue.validator('nonempty', {
              message: function (field) { // error message with function
                  return 'required "' + field + '" field'
              },
              required: true,
              minlength: 10
})


Vue.validator('email', {
        message: 'invalid email address', // error message with plain string
        check: function (val) { // define validator
          return /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(val)
        }
})


    // build-in `required` validator customization
Vue.validator('required', {
        message: function (field) { // error message with function
          return 'required "' + field + '" field'
        },
        check: Vue.validator('required') // re-use validator logic
})

function resetpost() {
      tinyMCE.activeEditor.setContent('');
      $('#postbody').attr('value','');
      $('#link').attr('value','');
      $('#posttitle').attr('value',''); 
      return false;
}

function sendmessage() {
    alert($('#message_reply_title').val());
    alert($('#message_reply_id').val());
    alert($('#message_sender_id').val());
    alert($('#response-text').val());
    $.ajax({
        method: "POST",
        url: "http://divorcesus.com/sendmessage/",
        data: { title: $('#message_reply_title').val(),
                message_id: $('#message_reply_id').val(),
                receiver_id:$('#message_sender_id').val(),
                body:$('#response-text').val()}
    }).done(function( msg ) {
                alert(msg);
    });

    return false;
}

function readmessage(id) {
   $.ajax({
       method: "POST",
       url: "http://divorcesus.com/readmessage",
       data: { message_id:id}
   }).done(function( msg ) {
      
      $('#mceu_13').removeClass("mce-tinymce mce-container mce-panel");
      $('.respond-back').html('<textarea id="response-text" class="inner-textarea"></textarea>');
      $('.panel-incoming-messages').hide();
      $('.panel-current-incoming-message').show();
      $('#message_reply_id').attr('value',msg.id);
      $('#message_reply_title').attr('value',msg.title);
      $('#message_reply_body').html(msg.body);
      $('#message_sender').html(msg.sender.username);
      $('#message_date_sent').html(msg.time_sent);
      $('#message_sender_id').attr('value',msg.sender.id);
   });
   return false;
}

function deletemessage(id,mode) {
              $.ajax({
                     method: "POST",
                     url: "http://divorcesus.com/deletemessage/",
                     data: {message_id:id,mode:mode}
              }).done(function( msg ) {

                           var result = '';

                           var res = msg.messages;

                           for(var i=0; i<res.length; i++) {
                               result=result+"<div style='float:left;width:30%;'>";
                               result=result+res[i].receiver.first_name;
                               result=result+' ';
                               result=result+res[i].receiver.last_name;
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:10%;'>";
                               result=result+res[i].time_sent;
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:29%;'>";
                               result=result+res[i].title;
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:15%;'>";
                               
                               if (mode===1) {
                                    result=result+"Resend";
                               } else {                               
                                    if (!res[i].is_seen) {

                                          result=result+"<a href='#' id='msg-"+res[i].id+"' onclick='readmessage("+res[i].id+");'  style='color:blue;font-weight:bold;'>Read</a>";
                                    } else {
                                          result=result+"<a href='#' id='msg-"+res[i].id+"' onclick='readmessage("+res[i].id+");'  style='color:blue;'>Read</a>";
                                    }
                               }
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:15%;'>";
                               if (mode===1) {
                                   result=result+"<a href='#' style='color:red;' onclick='deletemessage("+res[i].id+",1);'>Delete</a>";
                               } else {
                                   result=result+"<a href='#' style='color:red;' onclick='deletemessage("+res[i].id+",2);'>Delete</a>";
                               }
                               result=result+"</div>";
                               result=result+"<div class='clear'></div>";
                               result=result+"</div>"


                           }
                           if (mode===1) {
                                $('.panel-outgoing-messages').html(result);
                                $('.personal').show();
                           } else {
                                $('.panel-incoming-messages').html(result);
                           }


              });

   return false;
}

function editpost(id) {
   $.ajax({
                     method: "POST",
                     url: "http://divorcesus.com/readpost",
                     data: { post_id:id}
   }).done(function( msg ) {
      $('#post_id').attr('value',msg.id);
      $('#posttitle').attr('value',msg.title);
      $('#category_id').attr('value',msg.category.id);
      $('#link').attr('value',msg.link);
      $('.errors').html('');
      tinyMCE.activeEditor.setContent(msg.body); 
      $('#postbody').attr('value',msg.body); 
      $('#edit_post').attr('style','display:block;');
    //  $('post-editing-conianer').attr('style','display:block;');
      $('#editpost').show();
      $('#allposts').hide();
   });
   return false;
}

function editcomment(comment_id,post_id,comment_body) {

   //tinyMCE.execCommand('mceRemoveControl', true, 'edit_comment_body');

   var code = "<a href='#'"+
              " style='color:red;'"+
              " onclick='postcomments("+
              +post_id
              +");'>Back</a><br/><br/>";

  // tinyMCE.activeEditor.setContent(comment_body); 
   $('#comments_comment_id').attr('value',comment_id);
   $('#comments_post_id').attr('value',post_id);
   $('.panel-posts').html(code);
   $('#commentform').show();
   $('#mceu_13').css('width','90%');
   $('#mceu_13').css('margin-left','5%');
   tinyMCE.activeEditor.setContent(comment_body);
}

function deletecomment(comment_id,post_id) {
    $('.panel-posts').html('<a href="#" style="color:red;" onclick="restoreposts('+post_id+');">Back</a>');

              $.ajax({
                     method: "GET",
                     url: "http://divorcesus.com/deletecomment?comment_id="+comment_id+"&post_id="+post_id,
                     data: {}
              }).done(function( msg ) {
                           var result = '<a href="#" style="color:red;" onclick="restoreposts('+post_id+');">Back</a><br/><br/>';
                           result=result+"<div style='width:99%;'>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+'ID';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:12%;'>";
                           result=result+'Avatar';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'User';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:48%;'>";
                           result=result+'Comment';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:8%;'>";
                           result=result+'Edit';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+'Delete';
                           result=result+"</div>";

                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"


                       for(var i=0;i<msg.comments.length;i++) {
                           result=result+"<div style='width:99%;min-height:70px;'>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+msg.comments[i].id;
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:12%;'>";
                           result=result+"<img src='"+msg.comments[i].avatar+"' class='avatar-small' />";
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+msg.comments[i].username;
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:48%;'>";
                           result=result+msg.comments[i].body;
                           result=result+"</div>";


                           result=result+"<div style='float:left;width:8%;'>";
                           var call = "editcomment("+msg.comments[i].id+","+post_id+","+msg.comments[i].body+");";
                           call = call.replace(/'/g, '"');   
                           call = call.replace(/""/g, '"');
                           result=result+"<a href='#'";
                           result=result+" onclick='"+call+"'";
                           result=result+" style='color:blue;'>Edit</a>";
                           result=result+"</div>";


                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='deletecomment("+msg.comments[i].id+","+post_id+");'>Delete</a>";
                           result=result+"</div>";



                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"
                       }

                       $('.panel-posts').html(result);
                            
              });

    return false;


}

function postcomments(post_id) {
    $('#commentform').hide();
    $('.panel-posts').html('<a href="#" style="color:red;" onclick="restoreposts('+post_id+');">Back</a>');

              $.ajax({
                     method: "GET",
                     url: "http://divorcesus.com/getcomments?post_id="+post_id,
                     data: {}
              }).done(function( msg ) {
                           var result = '<a href="#" style="color:red;" onclick="restoreposts('+post_id+');">Back</a><br/><br/>';
                           result=result+"<div style='width:99%;'>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+'ID';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:12%;'>";
                           result=result+'Avatar';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'User';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:48%;'>";
                           result=result+'Comment';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:8%;'>";
                           result=result+'Edit';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+'Delete';
                           result=result+"</div>";

                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"
                    

                       for(var i=0;i<msg.comments.length;i++) {
                           result=result+"<div style='width:99%;min-height:70px;'>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+msg.comments[i].id;
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:12%;'>";
                           result=result+"<img src='"+msg.comments[i].avatar+"' class='avatar-small' />";
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+msg.comments[i].username;
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:48%;'>";
                           result=result+msg.comments[i].body;
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:8%;'>";
                           var call = "editcomment("+msg.comments[i].id+","+post_id+",\'"+msg.comments[i].body+"\');";
                           call = call.replace(/'/g, '"');
                           call = call.replace(/""/g, '"');
                           
                           result=result+"<a href='#'";
                           result=result+" onclick='"+call+"'";
                           result=result+" style='color:blue;'>Edit</a>";
                           result=result+"</div>";


                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='deletecomment("+msg.comments[i].id+","+post_id+");'>Delete</a>";
                           result=result+"</div>";



                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"
                       }

                       $('.panel-posts').html(result);
              });

    return false;
}


function restoreposts(post_id) {
              $('#commentform').hide();
              $.ajax({
                     method: "POST",
                     url: "http://divorcesus.com/getposts",
                     data: {}
              }).done(function( msg ) {
                       var result = '';

                           result=result+"<div style='width:96%;'>";
                           result=result+"<div style='float:left;width:2%;'>&nbsp;</div>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+'ID';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:45%;'>";
                           result=result+'Title';
                           result=result+"</div>";
/*
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+'Link';
                           result=result+"</div>";
*/
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'Edit';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'Delete';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'Comments';
                           result=result+"</div>";

                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"


                       for(var i=0;i<msg.length;i++) {
                           result=result+"<div style='width:96%;'>";
                           result=result+"<div style='float:left;width:2%;'>&nbsp;</div>";
                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+msg[i].id;
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:45%;'>";
                           result=result+msg[i].title;
                           result=result+"</div>";
/*  
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+msg[i].link;
                           result=result+"</div>";
*/
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+"<a href='#' onclick='editpost("+msg[i].id+");'  style='color:blue;'>Edit</a>";
                           result=result+"</div>";


                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='deletepost("+msg[i].id+");'>Delete</a>";
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='postcomments("+msg[i].id+");'>Comments</a>";
                           result=result+"</div>";


                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"
                       }


                       $('.panel-posts').html(result);
              });
    return false;
}

function deletepost(post_id) {
              $.ajax({
                     method: "POST",
                     url: "http://divorcesus.com/deleteblog",
                     data: { post_id:post_id}
              }).done(function( msg ) {
                       var result = '';

                           result=result+"<div style='width:96%;margin-top:2%;border-bottom:1px dotted;'>";
                           result=result+"<div style='float:left;width:2%;'>&nbsp;</div>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+'ID';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:45%;'>";
                           result=result+'Title';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'Edit';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'Delete';
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'Comments';
                           result=result+"</div>";

                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"

                       for(var i=0;i<msg.length;i++) {

                           result=result+"<div style='width:96%;'>";
                           result=result+"<div style='float:left;width:2%;'>&nbsp;</div>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+msg[i].id;
                           result=result+"</div>";
   
                           result=result+"<div style='float:left;width:45%;'>";
                           result=result+msg[i].title;
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+"<a href='#' onclick='editpost("+msg[i].id+");'  style='color:blue;'>Edit</a>";
                           result=result+"</div>";


                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='deletepost("+msg[i].id+");'>Delete</a>";
                           result=result+"</div>";
                            
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='postcomments("+msg[i].id+");'>Comments</a>";
                           result=result+"</div>";


                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"
                       }
                       $('.panel-posts').html(result);
              });

}

new Vue ({
        el: '#private_message', 

        data: {
          message_id:'',
          receiver_id:'',
          message_title:'',
          message_body:''  
        },

        methods: {

          edit: function (msg) {

          },

          send_message: function (msg) {


               $.ajax({
                     method: "POST",
                     url: "http://divorcesus.com/sendmessage/",
                     data: { title: $('#message_title').val(),
                             receiver_id:$('#receiver_id').val(), 
                             body:$('#message_body').val()}
              }).done(function( msg ) {
                           var result = '';
                           result=result+"<div style='width:99%;'>";

                           result=result+"<div style='float:left;width:20%;'>";
                           result=result+'Sent To';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:20%;'>";
                           result=result+'Time Sent';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:29%;'>";
                           result=result+'Title';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'Resend';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'Delete';
                           result=result+"</div>";
                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"

                           var res = msg.messages;
                               
                           for(var i = 0; i < res.length; i++) {
                            
                               result=result+"<div style='float:left;width:20%;'>";
                               result=result+res[i].reciever;
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:20%;'>";
                               result=result+res[i].time_sent;
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:29%;'>";
                               result=result+res[i].title;
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:15%;'>";
                               result=result+'Resend';
                               result=result+"</div>";
                               result=result+"<div style='float:left;width:15%;'>";
                               result=result+"<a href='#' style='color:red;' onclick='deletemessage("+res[i].id+",1);'>Delete</a>";
                               result=result+"</div>";
                               result=result+"<div class='clear'></div>";
                               result=result+"</div>"


                           }
                           
                           $('.panel-outgoing-messages').html(result);
                           openmenu('outgoing');
              });  
          }

        },
        validators: {
          nonempty: { // `nonempty` custom validator local registration
              message: function (field) {
                return 'invalid "' + field + '" must be non-empty at least 10 characters long'
              },
              check: function (str) {
                   return !(!str || 10 > str.length);
              }
          },
          numeric: { // `numeric` custom validator local registration
            message: 'invalid numeric value',
            check: function (val) {
              return /^[-+]?[0-9]+$/.test(val)
            }
          },
          url: { // `url` custom validator local registration
            message: function (field) {
              return 'invalid "' + field + '" url format field'
            },
            check: function (val) {
              return /^(http\:\/\/|https\:\/\/)(.{4,})$/.test(val)
            }
          }
        }

});


new Vue ({
          el: '#commentform',
          data: {
              comments_post_id:'',
              comments_comment_id:'',
          },
          methods: {
              edit: function(msg) {

                      $.ajax({
                             method: "POST",
                             url: "http://divorcesus.com/savecomment/",
                             data: {"comment_id":$('#comments_comment_id').val(),"post_id":$('#comments_post_id').val(),"body":tinyMCE.activeEditor.getContent()}
                      }).done(function( msg ) {

                           $('#commentform').hide();
                           var post_id = $('#comments_post_id').val();
                           var result = '<a href="#" style="color:red;" onclick="restoreposts('+post_id+');">Back</a><br/><br/>';
                           result=result+"<div style='width:99%;'>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+'ID';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:12%;'>";
                           result=result+'Avatar';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+'User';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:48%;'>";
                           result=result+'Comment';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:8%;'>";
                           result=result+'Edit';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+'Delete';
                           result=result+"</div>";

                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"

                       for(var i=0;i<msg.comments.length;i++) {
                           result=result+"<div style='width:99%;min-height:70px;'>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+msg.comments[i].id;
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:12%;'>";
                           result=result+"<img src='"+msg.comments[i].avatar+"' class='avatar-small' />";
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:15%;'>";
                           result=result+msg.comments[i].username;
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:48%;'>";
                           result=result+msg.comments[i].body;
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:8%;'>";
                           alert("WE ARE HERE FOUR"+post_id);
                           var call = "editcomment("+msg.comments[i].id+","+post_id+",'"+msg.comments[i].body+"');";
                           call = call.replace(/'/g, '"');


                           result=result+"<a href='#'";
                           result=result+" onclick='"+call+"'";
                           result=result+" style='color:blue;'>Edit</a>";
                           result=result+"</div>";


                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='deletecomment("+msg.comments[i].id+","+post_id+");'>Delete</a>";
                           result=result+"</div>";



                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"
                       }

                       $('.panel-posts').html(result);
                });          

              }
          },
          validators: {
          }
         });

new Vue({
        el: '#appform',
        data: {
          post_id:'',
          link:'',
          posttitle:'',
          postbody:'',
          category_id:''        
        },
        methods: {
          edit: function (msg) {
          },
          onReset: function () {
            this.$resetValidation()
          },
          editblog: function() {
              $.ajax({
                     method: "POST",
                     url: "http://divorcesus.com/savepost",
                     data: { title: $('#posttitle').val(),post_id: $('#post_id').val(),category_id:$('#category_id').val(), body:tinyMCE.activeEditor.getContent(), link:$('#link').val()}
              }).done(function( msg ) {
                       var result = '';

                           result=result+"<div style='width:96%;margin-top:2%;border-bottom:1px dotted;'>";
                           result=result+"<div style='float:left;width:2%;'>&nbsp;</div>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+'ID';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+'Title';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+'Link';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+'Edit';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+'Delete';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+'Comments';
                           result=result+"</div>";
                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"

                       for(var i=0;i<msg.length;i++) {
                           result=result+"<div style='width:96%;'>";
                           result=result+"<div style='float:left;width:2%;'>&nbsp;</div>";
                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+msg[i].id;
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+msg[i].title;
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+msg[i].link;
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+"<a href='#' onclick='editpost("+msg[i].id+");'  style='color:blue;'>Edit</a>";
                           result=result+"</div>";


                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='deletepost("+msg[i].id+");'>Delete</a>";
                           result=result+"</div>";


                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='postcomments("+msg[i].id+");'>Comments</a>";
                           result=result+"</div>";

                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"
                       }


                       $('.panel-posts').html(result);
              });


          },
          submitblog: function(){
           //   $('.newpost').hide();

              $.ajax({
                     method: "POST",
                     url: "http://divorcesus.com/postblog",
                     data: { title: $('#posttitle').val(),category_id:$('#category_id').val(), body:tinyMCE.activeEditor.getContent(), link:$('#link').val()}
              }).done(function( msg ) {
                       var result = '';

                           result=result+"<div style='width:96%;margin-top:2%;border-bottom:1px dotted;'>";
                           result=result+"<div style='float:left;width:2%;'>&nbsp;</div>";

                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+'ID';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+'Title';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+'Link';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+'Edit';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+'Delete';
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+'Comments';
                           result=result+"</div>";
                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"
                       
                       for(var i=0;i<msg.length;i++) {
                           result=result+"<div style='width:96%;'>";
                           result=result+"<div style='float:left;width:2%;'>&nbsp;</div>";
                           result=result+"<div style='float:left;width:5%;'>";
                           result=result+msg[i].id;
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+msg[i].title;
                           result=result+"</div>";
                           result=result+"<div style='float:left;width:30%;'>";
                           result=result+msg[i].link;
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+"<a href='#' onclick='editpost("+msg[i].id+");'  style='color:blue;'>Edit</a>";
                           result=result+"</div>";


                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='deletepost("+msg[i].id+");'>Delete</a>";
                           result=result+"</div>";

                           result=result+"<div style='float:left;width:10%;'>";
                           result=result+"<a href='#' style='color:red;' onclick='postcomments("+msg[i].id+");'>Comments</a>";
                           result=result+"</div>";


                           result=result+"<div class='clear'></div>";
                           result=result+"</div>"
                       }
 
                       $('.newpost .panel-all-your-posts').css('display','block');
                       $('#appform').css('display','none');
                       $('#commentform').css('display','none');
                       //$('.card').show();


                       $('.panel-posts').html(result);

              });


          } 
        },
        validators: {
          nonempty: { // `nonempty` custom validator local registration
              message: function (field) {
                return 'invalid "' + field + '" must be non-empty at least 10 characters long'
              },
              check: function (str) {
                   return !(!str || 10 > str.length);
              }
          },
          numeric: { // `numeric` custom validator local registration
            message: 'invalid numeric value',
            check: function (val) {
              return /^[-+]?[0-9]+$/.test(val)
            }
          },
          url: { // `url` custom validator local registration
            message: function (field) {
              return 'invalid "' + field + '" url format field'
            },
            check: function (val) {
              return /^(http\:\/\/|https\:\/\/)(.{4,})$/.test(val)
            }
          }
        }
      })
      
</script>

    </body>
</html>
